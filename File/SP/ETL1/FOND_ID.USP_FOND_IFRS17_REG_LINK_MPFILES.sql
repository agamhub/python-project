CREATE PROC [FOND_ID].[USP_FOND_IFRS17_REG_LINK_MPFILES] AS
BEGIN

--- PRE CREATE BACKUP RAW DATA FOR DUPLICACY REMOVAL
BEGIN TRY
TRUNCATE TABLE  FOND_ID.FOND_IFRS17_REG_LINK_MPFILES;
PRINT 'Table exist, TRUNCATE table..'
END TRY
BEGIN CATCH
	PRINT 'Table does not exists..'
END CATCH


-- INSERT TO CHECKING MPFILES TABLE
INSERT INTO  FOND_ID.FOND_IFRS17_REG_LINK_MPFILES
SELECT
0 AS SPCODE,
CONVERT(NUMERIC,CHDRNUM)  AS POL_NUMBER,
0 AS AGE_AT_ENTRY,
CASE WHEN SEX = 'M' THEN 0
WHEN SEX = 'F' THEN 1
ELSE 999 
END AS SEX,
99 - ANBCCD AS POL_TERM_Y,
0 AS ANNUAL_PREM,
0 AS PREM_PAYBL_Y,
COALESCE(BILLFREQ,0) AS PREM_FREQ,
COALESCE(SUMINS,0) AS SUM_ASSURED,
CASE WHEN MORTCLS = 'N' THEN 0
WHEN MORTCLS = 'S' THEN 1
ELSE 999
END AS SMOKER_STAT,
0 AS DURATIONIF_M,
0 AS INIT_POLS_IF,
0 AS INIT_UNFDU_A,
0 AS DIST_IND,
0 AS OCC_CLASS,
0 AS ACDTH_BEN,
0 AS ACDMB_BEN,
0 AS LIFE2_AGE_AE,
0 AS LIFE2_TERM_AGE_AE,
0 AS CESS_AGE_WP,
0 AS PWAIV_BEN,
0 AS PWAI2_BEN,
0 AS CESS_AGE_SP,
0 AS PRU_MED_BEN,
0 AS CC_BEN,
0 AS CC_EXP,
0 AS ADD_CC_BEN,
0 AS PLAN_CC,
0 AS PLAN_CCP,
0 AS LIFE3_AGE_AE,
0 AS LIFE3_TERM_AGE_AE,
0 AS TERM_BEN,
0 AS TERM_EXP,
0 AS MEDICAL_BEN,
0 AS PLAN_MED,
0 AS HSPLUS_IND,
0 AS MCC_BEN,
0 AS MCC_EXP,
0 AS CINCOME_BEN,
0 AS CINCOME_EXP,
0 AS ESCC_BEN,
0 AS ESCC_EXP,
CASE WHEN CNTCURR = 'IDR' THEN 1
WHEN CNTCURR = 'USD' THEN 2
ELSE 999
END AS CURR,
CASE WHEN ADMINCHG = 'Y' THEN 1
ELSE 0
END AS REDU_ADM,
0 AS ANN_PREM_BAS,
0 AS ANN_PREM_REC,
100 AS PRM_B_ALL_F1,
100 AS PRM_R_ALL_F1,
0 AS I_UNFDU_B_F1,
0 AS I_UNFDU_R_F1,
0 AS I_UNFDU_T_F1,
0 AS INIT_EXCS_DD,
0 AS I_EXCS_DD_B,
0 AS I_EXCS_DD_R,
0 AS NO_LAP_GTEE,
0 AS COMM_IND_B,
0 AS COMM_IND_R,
0 AS EXP_IND_B,
0 AS EXP_IND_R,
0 AS V_EXP_IND_B,
0 AS V_EXP_IND_R,
0 AS FUND_IND_B,
0 AS FUND_IND_R,
0 AS RI_ACDMB_BEN_PC,
0 AS RI_ACDTH_BEN_PC,
0 AS RI_ADD_CC_BEN_PC,
0 AS RI_BEN_CI,
0 AS RI_BEN_WAIV,
0 AS RI_BEN_WAIV2,
0 AS RI_CC_BEN_PC,
0 AS RI_CINCOME_BEN_PC,
0 AS RI_ESCC_BEN_PC,
0 AS RI_MCC_BEN_PC,
0 AS RI_PRU_HS_BEN_PC,
13 AS RI_PRU_MED_BEN_PC,
0 AS RI_PWAI2_BEN_PC,
0 AS RI_PWAIV_BEN_PC,
0 AS RI_SUMASSD_PC,
0 AS RI_TERM_BEN_PC,
0 AS REINS_IND,
0 AS MAX_AGE_AD,
0 AS MAX_AGE_ADD,
0 AS MAX_AGE_WAIV,
0 AS MAX_AGE_WAIV2,
COALESCE(RCESAGEHB,0) AS MAX_AGE_PMED,
0 AS MAX_AGE_ADD_CC,
0 AS MAX_AGE_HS,
0 AS MAX_AGE_TERM,
0 AS MAX_AGE_MCC,
0 AS MAX_AGE_CINCOME,
0 AS MAX_AGE_ESCC,
0 AS COI_TERM_DISCOUNT_TYPE,
0 AS RI_TABLE_IND,
0 AS RI_AD_IND,
0 AS RI_ADDB_IND,
0 AS RI_WAI_IND,
0 AS RI_WAI2_IND,
0 AS RI_MED_IND,
0 AS RI_ADD_CC_IND,
0 AS RI_HS_IND,
0 AS RI_TERM_IND,
0 AS RI_MCC_IND,
0 AS RI_CI_IND,
0 AS RI_ESCC_IND,
0 AS RI_CC_IND,
0 AS PW_IND_USED,
0 AS PH_IND_PP,
0 AS PLAN_PRNTL,
0 AS AGE_MT_PRNTL,
5 AS MAX_AGE_PNTL,
55 AS RI_PRU_PRNTL_BEN_PC,
0 AS JUVCI_EXP,
0 AS JUVCI_BEN,
50 AS RI_PRU_JUVCI_BEN_PC,
0 AS UPR_FAC,
0 AS ACDMB_IND,
0 AS ACDTH_IND,
0 AS ESCC_PLUS_IND,
0 AS PROD_NAME,
0 AS ALLOC_IND,
0 AS WP,
0 AS SP_TERM,
0 AS REGION,
0 AS SA_MULT_GRP,
0 AS SEX_2,
0 AS SEX_3,
0 AS SMOKER_STAT_2,
0 AS SMOKER_STAT_3,
0 AS TERM_BEN_3,
COALESCE((EDUP1SUM * 12),0) AS PEP_BEN_FIX,
COALESCE((EDUP2SUM * 12),0) AS PEP_BEN_FIX2,
0 AS MAX_AGE_PEP1,
0 AS MAX_AGE_PEP2,
COALESCE(RCESAGE3LT,0) AS MAX_AGE_TERM_3,
50 AS RI_PEP1_BEN_PC,
50 AS RI_PEP2_BEN_PC,
0 AS WOP_ESCC_IND,
0 AS WOP2_ESCC_IND,
0 AS CCB61_BEN,
0 AS CCB61_EXP,
0 AS MAX_AGE_CCB61,
40 AS RI_CCB61_BEN_PC,
0 AS HS_MONTH,
0 AS INIT_BON_F1,
0 AS INIT_BONP_F1,
0 AS BILL_CHNL,
0 AS BILL_CHNL2,
0 AS ANN_BON_PREM_BAS,
0 AS CI_BEN,
0 AS MAX_AGE_CI,
0 AS PLAN_CI,
50 AS RI_CI_BEN_PC,
COALESCE(SUMINS_DISABLE,0) AS TPD_BEN,
0 AS TPD_EXP,
0 AS MAX_AGE_TPD,
0 AS RI_TPD_BEN_PC,
0 AS PPH_PLUS_BEN,
0 AS PPH2_PLAN_MED,
0 AS PPH_PLUS_IND,
0 AS PPH2_HFA_IND,
0 AS MAX_AGE_PPH_PLUS,
0 AS RI_PPH_PLUS_BEN_PC,
0 AS SEL_FAC_IND
FROM FOND_ID.FOND_IFRS17_PROPHETU_REGION


END;
